{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport request from \"@/utils/request\";\nimport { setToken } from \"@/utils/auth\";\nimport Cookies from \"js-cookie\";\nimport axios from \"axios\";\nexport default {\n  name: \"Login\",\n  data() {\n    return {\n      admin: {},\n      loginAdmin: {},\n      imgList: [require('../../assets/img1.jpg'), require('../../assets/img2.jpg'), require('../../assets/img3.jpg'), require('../../assets/img4.jpg')],\n      rules: {\n        username: [{\n          required: true,\n          message: '请输入用户名',\n          trigger: 'blur'\n        }, {\n          min: 3,\n          max: 10,\n          message: '长度在3-10个字符',\n          trigger: 'blur'\n        }],\n        password: [{\n          required: true,\n          message: '请输入密码',\n          trigger: 'blur'\n        }, {\n          min: 3,\n          max: 10,\n          message: '长度在3-10个字符',\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  methods: {\n    login() {\n      this.$refs['loginForm'].validate(valid => {\n        if (valid) {\n          request.post('/login', this.admin).then(res => {\n            // console.log(\"test\")\n            if (res.code === 200) {\n              // 弹出滑块组件并将后端返回的数据赋值给loginAdmin\n              this.loginAdmin = res.data;\n              localStorage.setItem(\"token\", this.loginAdmin.token);\n              setToken(this.loginAdmin.token);\n            } else {\n              this.$notify.error(res.msg);\n            }\n          });\n        }\n      });\n    },\n    // 滑块验证成功后\n    onSuccess() {\n      console.log('onSuccess');\n      let json;\n      if (this.loginAdmin !== null) {\n        json = {\n          \"id\": Number(this.loginAdmin.id),\n          \"username\": this.loginAdmin.username,\n          \"phone\": this.loginAdmin.phone,\n          \"email\": this.loginAdmin.email\n        };\n        Cookies.set(\"admin\", JSON.stringify(json));\n      }\n      console.log(\"login\");\n      if (Number(this.loginAdmin.id) === 1) {\n        this.$notify.success(\"超级管理员\" + this.loginAdmin.username + \"，你好！\");\n      } else {\n        this.$notify.success(\"普通管理员\" + this.loginAdmin.username + \"，你好！\");\n      }\n      this.$router.push('/');\n    },\n    onFail() {\n      console.log('onFail');\n    },\n    onRefresh() {\n      console.log('onRefresh');\n    },\n    esc() {\n      this.loginAdmin = {};\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}